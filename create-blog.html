<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Create Blog Post</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body style="background:#020817;">
    <div class="container mt-5" style="max-width:600px;">
        <h2 class="text-white mb-4">Create Blog Post</h2>
        <form id="editBlogForm">
            <div class="form-group">
                <label class="text-white">Header</label>
                <input type="text" class="form-control" id="blogHeader" required>
            </div>
            <div class="form-group">
                <label class="text-white">Title</label>
                <input type="text" class="form-control" id="blogTitle" required>
            </div>
            <div class="form-group">
                <label class="text-white">Description</label>
                <input type="text" class="form-control" id="blogDesc" required>
            </div>
            <div class="form-group">
                <label class="text-white">Image URL</label>
                <input type="text" class="form-control" id="blogImage" required>
            </div>
            <div class="form-group">
                <label class="text-white">Text</label>
                <textarea class="form-control" id="blogText" rows="5" required></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Save Blog</button>
            <a href="index.html" class="btn btn-secondary ml-2">Cancel</a>
        </form>
    </div>
    <script>
        function isAdmin() {
            return localStorage.getItem('isAdmin') === 'true';
        }

        document.getElementById('editBlogForm').onsubmit = async function(e) {
            e.preventDefault();
            if (!isAdmin()) {
                alert('Only admin can create posts.');
                return false;
            }
            const blog = {
                header: document.getElementById('blogHeader').value,
                title: document.getElementById('blogTitle').value,
                description: document.getElementById('blogDesc').value,
                image: document.getElementById('blogImage').value,
                text: document.getElementById('blogText').value
            };

            const res = await fetch('/.netlify/functions/create-blog', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(blog)
            });

            const data = await res.json();
            if (data.success) {
                alert('Blog post created!');
                window.location.href = 'index.html#blogs';
            } else {
                alert('Error: ' + (data.error || 'Unknown error'));
            }
        };
    </script>
</body>
</html>